Hello world
============================================================================================
Device set to : NVIDIA GeForce RTX 3080
============================================================================================
Warning: No joystick found!
crazyflie id: 1
100000000.0 8
loading model :  deq-1-mpc_FlyingCartpole_obstacles_lr1e3_ineqfix_innerdeqinpGN_andersongoodgradlast_phontom3ReLU_03sdata_qpsolve_gradclip2_noemb_Q10-10-80-1-1R1e8_ub03obsr04_again_T5_bsz200_deq_iter1_hdim1024_valfrac1.0
press 1 button to takeoff
crazyflie position: [-2.4906 -0.8078  0.7541]
crazyflie position: [-2.4906 -0.8078  0.7541]
crazyflie position: [-2.4906 -0.8077  0.7541]
crazyflie position: [-2.4906 -0.8078  0.7541]
crazyflie position: [-2.4906 -0.8078  0.7542]
crazyflie position: [-2.4906 -0.8078  0.7541]
crazyflie position: [-2.4906 -0.8078  0.7541]
1press 2 button to run DEQ-MPC scenerio
2desired pos:  [-2.539  -0.8102  0.977 ] [-3.6815 -4.5073 -3.1944] [-3.6815 -4.508  -3.2178]
desired pos:  [-2.5393 -0.8164  0.9833] [-3.6848 -4.5696 -3.1316] [-3.6851 -4.5786 -3.2047]
desired pos:  [-2.5386 -0.8139  0.9872] [-3.6775 -4.544  -3.0923] [-3.6832 -4.5737 -3.2139]
desired pos:  [-2.5393 -0.8114  0.9849] [-3.685  -4.5188 -3.1158] [-3.7047 -4.5774 -3.279 ]
desired pos:  [-2.5424 -0.8087  0.9831] [-3.7152 -4.4923 -3.1338] [-3.756  -4.5844 -3.3331]
desired pos:  [-2.5456 -0.8059  0.9859] [-3.7473 -4.4642 -3.1055] [-3.8154 -4.5922 -3.3384]
desired pos:  [-2.5483 -0.8027  0.9896] [-3.7751 -4.4319 -3.069 ] [-3.8767 -4.5961 -3.3331]
desired pos:  [-2.5534 -0.7992  0.9904] [-3.826  -4.3973 -3.0607] [-3.9674 -4.5969 -3.3496]
desired pos:  [-2.5574 -0.7949  0.991 ] [-3.8658 -4.3545 -3.0548] [-4.0536 -4.5886 -3.3626]
desired pos:  [-2.5591 -0.7902  0.9938] [-3.8827 -4.3075 -3.0267] [-4.1225 -4.5768 -3.3502]
desired pos:  [-2.5603 -0.785   0.997 ] [-3.8945 -4.2554 -2.9944] [-4.1893 -4.5614 -3.3303]
desired pos:  [-2.5597 -0.7802  0.9993] [-3.8883 -4.2071 -2.9718] [-4.237  -4.5527 -3.3212]
desired pos:  [-2.5585 -0.7748  1.0026] [-3.8771 -4.1528 -2.9382] [-4.274  -4.5397 -3.3071]
desired pos:  [-2.5581 -0.7691  1.0083] [-3.8723 -4.0964 -2.882 ] [-4.3081 -4.5223 -3.2723]
desired pos:  [-2.5573 -0.7642  1.0135] [-3.8647 -4.0475 -2.8299] [-4.3311 -4.5061 -3.2421]
desired pos:  [-2.5567 -0.7587  1.0197] [-3.8583 -3.9924 -2.7673] [-4.3514 -4.4769 -3.2137]
desired pos:  [-2.5564 -0.7521  1.0277] [-3.8557 -3.9266 -2.6879] [-4.3697 -4.4299 -3.1719]
desired pos:  [-2.5558 -0.7441  1.037 ] [-3.8493 -3.8465 -2.5945] [-4.3748 -4.3636 -3.1213]
desired pos:  [-2.5562 -0.7353  1.0485] [-3.8533 -3.7579 -2.4792] [-4.3786 -4.2854 -3.0621]
desired pos:  [-2.5569 -0.726   1.0588] [-3.8607 -3.6652 -2.3766] [-4.3721 -4.1984 -3.008 ]
desired pos:  [-2.558  -0.7193  1.0649] [-3.8717 -3.5986 -2.3159] [-4.3645 -4.1132 -2.9298]
desired pos:  [-2.5598 -0.708   1.0765] [-3.8895 -3.4856 -2.1996] [-4.3507 -4.0154 -2.8259]
desired pos:  [-2.5617 -0.6987  1.0858] [-3.9085 -3.3924 -2.1066] [-4.342  -3.9211 -2.7189]
desired pos:  [-2.5615 -0.6884  1.0929] [-3.9066 -3.2889 -2.036 ] [-4.3312 -3.8208 -2.6284]
desired pos:  [-2.56   -0.6792  1.1019] [-3.8922 -3.1976 -1.9453] [-4.3199 -3.7368 -2.5545]
desired pos:  [-2.5588 -0.6677  1.1173] [-3.8796 -3.0825 -1.7912] [-4.3186 -3.6325 -2.4521]
desired pos:  [-2.5577 -0.6571  1.1328] [-3.8692 -2.9757 -1.6371] [-4.3316 -3.5347 -2.35  ]
desired pos:  [-2.5567 -0.646   1.1458] [-3.8582 -2.8649 -1.507 ] [-4.3487 -3.4305 -2.257 ]
desired pos:  [-2.5555 -0.6365  1.1602] [-3.8472 -2.7701 -1.3626] [-4.3709 -3.3387 -2.1381]
desired pos:  [-2.5536 -0.6273  1.1786] [-3.8281 -2.6781 -1.1786] [-4.3897 -3.2473 -1.9854]
desired pos:  [-2.5508 -0.6179  1.1972] [-3.7997 -2.5846 -0.993 ] [-4.3999 -3.1561 -1.8396]
desired pos:  [-2.5473 -0.6079  1.217 ] [-3.7647 -2.4837 -0.795 ] [-4.4047 -3.0583 -1.6887]
desired pos:  [-2.5422 -0.6     1.2334] [-3.7138 -2.4055 -0.6303] [-4.3906 -2.983  -1.576 ]
desired pos:  [-2.5378 -0.5901  1.2542] [-3.67   -2.3061 -0.4231] [-4.3777 -2.8854 -1.4202]
desired pos:  [-2.5341 -0.5823  1.2737] [-3.6327 -2.2283 -0.2281] [-4.3648 -2.8065 -1.2774]
desired pos:  [-2.5307 -0.5746  1.2936] [-3.5983 -2.1511 -0.0289] [-4.3488 -2.7247 -1.1334]
desired pos:  [-2.5271 -0.5671  1.3147] [-3.5625 -2.0763  0.1821] [-4.3263 -2.6412 -0.9787]
desired pos:  [-2.523  -0.5577  1.3403] [-3.522  -1.9825  0.4385] [-4.2939 -2.5355 -0.7647]
desired pos:  [-2.5202 -0.5494  1.3644] [-3.4933 -1.8989  0.6793] [-4.2684 -2.4394 -0.5276]
desired pos:  [-2.5176 -0.5425  1.3819] [-3.4679 -1.8299  0.8542] [-4.2425 -2.3569 -0.3435]
desired pos:  [-2.5151 -0.5369  1.4002] [-3.4429 -1.7737  1.0372] [-4.2136 -2.2851 -0.1639]
desired pos:  [-2.513  -0.5305  1.4201] [-3.4212 -1.7104  1.2362] [-4.1865 -2.2066  0.0443]
desired pos:  [-2.5114 -0.5247  1.4382] [-3.406  -1.6518  1.417 ] [-4.1657 -2.1337  0.2538]
desired pos:  [-2.509  -0.5186  1.4532] [-3.3812 -1.5909  1.5677] [-4.136  -2.06    0.4526]
desired pos:  [-2.5054 -0.5093  1.4753] [-3.346  -1.4985  1.788 ] [-4.0963 -1.9559  0.734 ]
desired pos:  [-2.5017 -0.5     1.4946] [-3.3084 -1.4054  1.9811] [-4.0535 -1.8513  0.9888]
desired pos:  [-2.5002 -0.494   1.505 ] [-3.2933 -1.3451  2.0852] [-4.0327 -1.7798  1.1548]
desired pos:  [-2.498  -0.488   1.5132] [-3.2717 -1.2852  2.1676] [-4.0044 -1.7091  1.299 ]
desired pos:  [-2.4967 -0.482   1.5246] [-3.2589 -1.2256  2.2814] [-3.9834 -1.6393  1.4741]
desired pos:  [-2.496  -0.4759  1.5351] [-3.2514 -1.1644  2.3863] [-3.9662 -1.569   1.6397]
desired pos:  [-2.4932 -0.4654  1.5496] [-3.2238 -1.0594  2.5309] [-3.9277 -1.4556  1.8445]
desired pos:  [-2.4921 -0.4562  1.5599] [-3.2124 -0.9667  2.6343] [-3.9046 -1.3547  2.0072]
desired pos:  [-2.4909 -0.4485  1.5694] [-3.2003 -0.8901  2.7297] [-3.8794 -1.2688  2.1622]
desired pos:  [-2.4887 -0.4425  1.5772] [-3.1791 -0.8298  2.8072] [-3.8421 -1.1975  2.3015]
desired pos:  [-2.4877 -0.4375  1.584 ] [-3.1682 -0.78    2.8754] [-3.8098 -1.1345  2.4336]
desired pos:  [-2.4863 -0.4323  1.5881] [-3.1551 -0.7281  2.9163] [-3.7688 -1.0673  2.5402]
desired pos:  [-2.4857 -0.4272  1.5882] [-3.1491 -0.677   2.9176] [-3.7305 -0.9999  2.6106]
desired pos:  [-2.4868 -0.4232  1.586 ] [-3.1598 -0.6367  2.8955] [-3.7062 -0.9434  2.6604]
desired pos:  [-2.4876 -0.4176  1.5831] [-3.1679 -0.5812  2.8664] [-3.6773 -0.8726  2.7029]
desired pos:  [-2.4896 -0.4127  1.5802] [-3.188  -0.532   2.8372] [-3.6601 -0.8097  2.7449]
desired pos:  [-2.4905 -0.4043  1.5771] [-3.1969 -0.4481  2.8067] [-3.6321 -0.7135  2.7838]
desired pos:  [-2.4929 -0.3965  1.5699] [-3.221  -0.3706  2.7339] [-3.6202 -0.6253  2.778 ]
desired pos:  [-2.4961 -0.3922  1.5623] [-3.2528 -0.3271  2.6582] [-3.6177 -0.5724  2.7669]
desired pos:  [-2.4987 -0.3857  1.5533] [-3.2789 -0.2621  2.5682] [-3.6121 -0.4989  2.7374]
desired pos:  [-2.5026 -0.3795  1.5437] [-3.3177 -0.1997  2.4724] [-3.6194 -0.4277  2.6847]
desired pos:  [-2.5064 -0.3729  1.5322] [-3.3554 -0.1338  2.3573] [-3.629  -0.3538  2.61  ]
desired pos:  [-2.5105 -0.3666  1.5198] [-3.397  -0.0712  2.2329] [-3.6488 -0.2843  2.54  ]
desired pos:  [-2.5135 -0.3629  1.51  ] [-3.427  -0.0337  2.1352] [-3.6585 -0.2396  2.4829]
desired pos:  [-2.5178 -0.3585  1.5005] [-3.4702  0.0097  2.0405] [-3.6799 -0.1876  2.3841]
desired pos:  [-2.5209 -0.3551  1.493 ] [-3.5005  0.0439  1.965 ] [-3.6906 -0.1443  2.288 ]
desired pos:  [-2.5255 -0.3505  1.4813] [-3.547   0.0899  1.8482] [-3.7219 -0.0896  2.1685]
desired pos:  [-2.5325 -0.3455  1.4708] [-3.6168  0.14    1.7431] [-3.7761 -0.0292  2.0469]
desired pos:  [-2.5358 -0.3425  1.4669] [-3.6497  0.1694  1.7046] [-3.7905  0.0127  1.9666]
desired pos:  [-2.5424 -0.3378  1.4602] [-3.7152  0.2165  1.6375] [-3.838   0.0721  1.8522]
desired pos:  [-2.5482 -0.3337  1.4535] [-3.7735  0.2578  1.5703] [-3.8854  0.1253  1.7441]
desired pos:  [-2.5506 -0.331   1.4457] [-3.798   0.2847  1.4924] [-3.9143  0.1628  1.6709]
desired pos:  [-2.5509 -0.3272  1.4353] [-3.8003  0.323   1.3885] [-3.9573  0.2106  1.5879]
desired pos:  [-2.5467 -0.3226  1.4261] [-3.7582  0.369   1.2961] [-4.012   0.2637  1.5032]
desired pos:  [-2.5396 -0.3181  1.4146] [-3.6881  0.4143  1.1814] [-4.0747  0.3122  1.4159]
desired pos:  [-2.5301 -0.315   1.4027] [-3.5928  0.4444  1.0627] [-4.1229  0.3439  1.3386]
desired pos:  [-2.5223 -0.3137  1.3891] [-3.5145  0.4575  0.9261] [-4.184   0.3598  1.2349]
desired pos:  [-2.5135 -0.3148  1.3778] [-3.4268  0.4469  0.813 ] [-4.2182  0.3539  1.1287]
desired pos:  [-2.5039 -0.3169  1.3693] [-3.3304  0.4261  0.7281] [-4.2138  0.3397  1.0307]
desired pos:  [-2.4954 -0.3177  1.3598] [-3.2459  0.4181  0.6333] [-4.1865  0.3394  0.9129]
desired pos:  [-2.4877 -0.3182  1.3517] [-3.1684  0.4128  0.552 ] [-4.1345  0.3423  0.7919]
desired pos:  [-2.483  -0.3174  1.3465] [-3.1218  0.4204  0.5002] [-4.0778  0.3572  0.6789]
desired pos:  [-2.4801 -0.3158  1.3409] [-3.0923  0.4366  0.4448] [-4.0172  0.3749  0.5753]
desired pos:  [-2.4777 -0.3132  1.3302] [-3.069   0.4631  0.3373] [-3.9533  0.401   0.4791]
desired pos:  [-2.4745 -0.3102  1.3172] [-3.037   0.4931  0.2072] [-3.8853  0.4314  0.4122]
desired pos:  [-2.4729 -0.3066  1.3089] [-3.0205  0.5286  0.1239] [-3.8148  0.4683  0.3593]
desired pos:  [-2.4734 -0.3007  1.3013] [-3.0261  0.5878  0.0481] [-3.7394  0.5304  0.2714]
desired pos:  [-2.4765 -0.2943  1.2921] [-3.0569  0.6515 -0.0439] [-3.6736  0.5977  0.1593]
desired pos:  [-2.4809 -0.2878  1.285 ] [-3.1006  0.7168 -0.1147] [-3.6172  0.6665  0.0736]
desired pos:  [-2.4855 -0.2809  1.2793] [-3.1468  0.7863 -0.1718] [-3.5742  0.7383  0.0102]
desired pos:  [-2.4855 -0.2736  1.2679] [-3.1463  0.8585 -0.2858] [-3.5215  0.8105 -0.0739]
desired pos:  [-2.4828 -0.2647  1.2512] [-3.1193  0.9474 -0.4528] [-3.4808  0.8976 -0.1821]
desired pos:  [-2.4791 -0.2573  1.2422] [-3.0829  1.0221 -0.5425] [-3.4677  0.9693 -0.2597]
desired pos:  [-2.4704 -0.2487  1.2359] [-2.9958  1.1075 -0.6061] [-3.445   1.0542 -0.3529]
desired pos:  [-2.4595 -0.2424  1.2265] [-2.8869  1.1705 -0.6993] [-3.4237  1.1221 -0.4684]
desired pos:  [-2.4471 -0.2368  1.2181] [-2.7626  1.227  -0.7833] [-3.3913  1.189  -0.5719]
desired pos:  [-2.4344 -0.2326  1.2135] [-2.6358  1.2684 -0.8293] [-3.3468  1.2446 -0.6451]
desired pos:  [-2.4214 -0.2275  1.2084] [-2.5054  1.3197 -0.881 ] [-3.2799  1.3117 -0.7328]
desired pos:  [-2.4069 -0.2226  1.2033] [-2.3608  1.369  -0.9317] [-3.1802  1.3771 -0.828 ]
desired pos:  [-2.3922 -0.2178  1.2005] [-2.214   1.4173 -0.9592] [-3.0621  1.4413 -0.905 ]
desired pos:  [-2.3797 -0.2145  1.2002] [-2.0884  1.4498 -0.9628] [-2.9424  1.4888 -0.9602]
desired pos:  [-2.3691 -0.2109  1.1987] [-1.9826  1.486  -0.9775] [-2.7893  1.5472 -1.0229]
desired pos:  [-2.3518 -0.2064  1.192 ] [-1.8098  1.5311 -1.0446] [-2.6255  1.59   -1.0793]
desired pos:  [-2.3373 -0.2017  1.1851] [-1.6644  1.5775 -1.1132] [-2.469   1.6389 -1.1079]
desired pos:  [-2.325  -0.1977  1.185 ] [-1.5417  1.6183 -1.1143] [-2.3273  1.6831 -1.1184]
desired pos:  [-2.3116 -0.193   1.1869] [-1.4079  1.6649 -1.0954] [-2.1609  1.7354 -1.146 ]
desired pos:  [-2.3018 -0.1891  1.187 ] [-1.3099  1.704  -1.0941] [-2.0184  1.783  -1.1908]
desired pos:  [-2.2927 -0.1857  1.1882] [-1.2184  1.7383 -1.0826] [-1.8723  1.8303 -1.2212]
desired pos:  [-2.2859 -0.183   1.1913] [-1.1511  1.7648 -1.0514] [-1.7438  1.8749 -1.2268]
desired pos:  [-2.2775 -0.1809  1.1942] [-1.0668  1.7859 -1.0225] [-1.5955  1.9199 -1.2288]
desired pos:  [-2.2695 -0.1797  1.1963] [-0.9866  1.7976 -1.0018] [-1.4526  1.9608 -1.2338]
desired pos:  [-2.2616 -0.1796  1.1992] [-0.9079  1.7985 -0.9725] [-1.319   1.9929 -1.226 ]
desired pos:  [-2.2502 -0.178   1.2018] [-0.7941  1.8144 -0.9462] [-1.1678  2.032  -1.2071]
desired pos:  [-2.2394 -0.1766  1.2029] [-0.6859  1.8286 -0.9357] [-1.0446  2.0584 -1.1836]
desired pos:  [-2.2281 -0.1763  1.207 ] [-0.573   1.8319 -0.8946] [-0.9357  2.0694 -1.1478]
desired pos:  [-2.2163 -0.1765  1.2146] [-0.4547  1.8298 -0.8185] [-0.834   2.0748 -1.1104]
desired pos:  [-2.2034 -0.1769  1.2227] [-0.3261  1.8256 -0.7376] [-0.7269  2.0798 -1.0757]
desired pos:  [-2.1904 -0.1776  1.2294] [-0.1962  1.8191 -0.6703] [-0.6161  2.0846 -1.0466]
desired pos:  [-2.1796 -0.1784  1.2368] [-0.0876  1.8109 -0.5965] [-0.5195  2.089  -1.0075]
desired pos:  [-2.1694 -0.1791  1.2469] [ 0.0139  1.8039 -0.4956] [-0.4197  2.0943 -0.9528]
desired pos:  [-2.1603 -0.1796  1.258 ] [ 0.1049  1.7993 -0.3842] [-0.3186  2.099  -0.8915]
desired pos:  [-2.1501 -0.18    1.2716] [ 0.207   1.7947 -0.2483] [-0.195   2.0986 -0.7998]
desired pos:  [-2.1425 -0.18    1.2842] [ 0.2834  1.7945 -0.1223] [-0.079   2.0958 -0.7086]
desired pos:  [-2.1382 -0.1799  1.2932] [ 0.3263  1.7957 -0.0323] [ 0.0276  2.0905 -0.5959]
desired pos:  [-2.1338 -0.1796  1.3087] [0.3703 1.7992 0.1227] [ 0.1221  2.0859 -0.4716]
desired pos:  [-2.1319 -0.179   1.3232] [0.3891 1.8047 0.2669] [ 0.2069  2.0871 -0.3563]
desired pos:  [-2.1296 -0.1809  1.3351] [0.4126 1.7854 0.3863] [ 0.278   2.0685 -0.2361]
desired pos:  [-2.1274 -0.1826  1.3435] [0.4342 1.7693 0.4703] [ 0.3379  2.0537 -0.1076]
desired pos:  [-2.1276 -0.1839  1.3574] [0.4324 1.7557 0.6094] [0.3885 2.0404 0.0347]
desired pos:  [-2.1288 -0.1838  1.3733] [0.4206 1.7569 0.7687] [0.4391 2.0395 0.1577]
desired pos:  [-2.1315 -0.1847  1.3879] [0.393  1.7482 0.9146] [0.4736 2.0258 0.2663]
desired pos:  [-2.135  -0.1843  1.4041] [0.3579 1.7516 1.0766] [0.5006 2.0214 0.3913]
desired pos:  [-2.1377 -0.1833  1.4163] [0.331  1.762  1.1985] [0.5231 2.0234 0.5271]
desired pos:  [-2.1411 -0.1832  1.4237] [0.2974 1.7631 1.2725] [0.5256 2.0168 0.6644]
desired pos:  [-2.1441 -0.1841  1.4311] [0.2677 1.7541 1.3469] [0.529  1.9998 0.8047]
desired pos:  [-2.1478 -0.1851  1.4374] [0.2298 1.7441 1.409 ] [0.5191 1.9822 0.9296]
desired pos:  [-2.1528 -0.1849  1.443 ] [0.18   1.7454 1.4649] [0.489  1.9773 1.0417]
desired pos:  [-2.158  -0.1855  1.447 ] [0.1283 1.7394 1.5055] [0.4464 1.9684 1.1337]
desired pos:  [-2.1618 -0.1872  1.4495] [0.0902 1.7225 1.5301] [0.4062 1.9539 1.2106]
desired pos:  [-2.1654 -0.1892  1.453 ] [0.0543 1.7033 1.5657] [0.3645 1.9415 1.2926]
desired pos:  [-2.168  -0.1905  1.455 ] [0.0282 1.6896 1.5852] [0.3307 1.9422 1.3498]
desired pos:  [-2.1785 -0.1969  1.4559] [-0.0764  1.6262  1.5944] [0.2264 1.9212 1.445 ]
desired pos:  [-2.1813 -0.1996  1.4429] [-0.105   1.5985  1.4644] [0.1872 1.9144 1.3767]
desired pos:  [-2.1823 -0.2016  1.3886] [-0.1145  1.5785  0.9212] [0.1521 1.9156 0.8913]
desired pos:  [-2.1527 -0.1927  1.2872] [ 0.1816  1.6674 -0.0931] [ 0.3776  2.0453 -0.0174]
> /home/swami/Workspace/diff-qp-mpc/deqmpc/run_hw.py(349)eval_streaming_policy()
    348 
--> 349         state_hist = torch.cat((state_hist, state[:,None,:].cpu()), dim=1)
    350         # ipdb.set_trace()

